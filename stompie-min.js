angular.module("stompie",[]).factory("$stompie",["$rootScope","$timeout",function(e,t){"use strict";var n={},r=null,i=[],s={};var o=function(){if(r!==null){s.client=new SockJS(r);s.stomp=Stomp.over(s.client);s.stomp.connect({},a,u)}};var u=function(){t(function(){o()},3e3)};var a=function(){e.$apply(function(){for(var e=0;e<i.length;e++){i[e]()}})};n._connect=function(e,t){r=e;o();i.push(t)};n.using=function(e,t){if(r===null||e!=r){n._connect(e,t)}else{i.push(t)}};n.disconnect=function(e){s.stomp.disconnect(e)};n.subscribe=function(t,n){return s.stomp.subscribe(t,function(t){var r=null;try{r=JSON.parse(t.body)}finally{e.$digest(n(r))}})};n.send=function(e,t,n){try{var r=JSON.stringify(t);s.stomp.send(e,{priority:n!==undefined?n:9},r)}catch(i){throw i}return this};return n}])